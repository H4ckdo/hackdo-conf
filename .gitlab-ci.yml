staging:
  type: deploy
  script:
  - apt-get update -qy
  - apt-get install -y ruby-dev
  - curl -sL https://deb.nodesource.com/setup_7.x | bash -
  - apt-get install -y nodejs
  - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | sudo apt-key add -
  - echo "deb https://dl.yarnpkg.com/debian/ stable main" | sudo tee /etc/apt/sources.list.d/yarn.list
  - yarn install --pure-lockfile
  - yarn --only=dev
  - node app.js
  - yarn global add bower gulp
  - bower install --allow-root
  - gulp sass js
  - gem install dpl
  - dpl --provider=heroku --skip_cleanup=true --app=hackdo-website --api-key=$HEROKU_STAGING_API_KEY
  only:
  - master
production:
  type: deploy
  script:
  - apt-get update -qy
  - apt-get install -y ruby-dev
  - gem install dpl
  - dpl --provider=heroku --skip_cleanup=true --app=hackdo-website --api-key=$HEROKU_PRODUCTION_API_KEY
